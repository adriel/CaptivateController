/*
CaptivateController() v0.10.20130312
https://github.com/pipwerks/CaptivateController
Copyright (c) Philip Hutchison
MIT-style license: http://pipwerks.mit-license.org/
*/
var CaptivateController=function(e,t){if(typeof e==="undefined"){return false}var n="cpSkinLoader_mc.",r="rdcmnd",i="cpCmnd",s,o="undefined",u="unknown",a="number",f=true,l=false,c=this,h=null,p="",d=l,v="",m="GetVariable",g="SetVariable",y="CaptivateVersion",b=l,w=l,E=document.getElementById(e);if(!E){return l}var S=function(){var e=null,a=null,f=null,c=null,w=null,S=null,x=l,T=l,N=l,C,k,L,A,O,M;if(typeof E.cpEIGetValue!==o){try{f=E.cpEIGetValue(y)}catch(_){}try{c=E.cpEIGetValue(n+y)}catch(D){}}if(typeof E.cpGetValue!==o){try{e=E.cpGetValue(y)}catch(P){}try{a=E.cpGetValue(n+y)}catch(H){}}if(typeof E.GetVariable!==o){try{w=E.GetVariable(y)}catch(B){}try{S=E.GetVariable(n+y)}catch(j){}}C=typeof w;k=typeof S;L=typeof e;A=typeof a;O=typeof f;M=typeof c;N=C!==o&&C!==u&&w!==null||k!==o&&k!==u&&S!==null||l;x=L!==o&&L!==u&&e!==null||A!==o&&A!==u&&a!==null||l;T=O!==o&&O!==u&&f!==null||M!==o&&M!==u&&c!==null||l;p=T?f||c||l:x?e||a||l:w||S||l;d=p!==l;if(!d){return l}h=parseInt(p.replace(/v/gi,"").split(".")[0],10);b=h>4||h>3&&!N;if(T){m="cpEIGetValue";g="cpEISetValue"}else if(x){m="cpGetValue";g="cpSetValue"}if(!t){var F=h>3?"isCPMovie":"rdIsMainMovie",I=l;try{var q=E[m](n+F),R=typeof q;I=R!==o&&R!==u&&q!==null}catch(U){}t=I}v=t?n:"";s=h>3?i:r};var x=function(){if(h===null){S()}return d};var T=function(e,t){if(!x()){return l}if(typeof t===o){t=1}switch(e){case"pause":e=r+"Pause";break;case"resume":e=r+"Resume";break;case"next":e=r+"NextSlide";break;case"previous":e=r+"Previous";break;case"rewindAndStop":if(h===5){e=s+"GotoSlide";t=0}else{e=r+"RewindAndStop"}break;case"rewindAndPlay":e=h===5?l:r+"RewindAndPlay";if(h===5){E[g](v+r+"Pause",1);e=r+"GotoFrameAndResume"}else{e=r+"RewindAndPlay"}break;case"gotoSlideAndPlay":if(!w){t=t-1}E[g](v+s+"GotoSlide",t);e=s+"Resume";t=1;break;case"gotoSlideAndStop":if(!w){t=t-1}e=s+"GotoSlide";break;case"gotoFrameAndPlay":E[g](v+r+"Pause",1);e=r+"GotoFrameAndResume";break;case"gotoFrameAndStop":e=r+"GotoFrame";break;case"volume":e=i+"Volume";break;case"mute":e=s+"Mute";break;case"unmute":e=s+"Mute";t=0;break;case"muteAndShowCaptions":E[g](v+s+"Mute",1);e=s+"CC";break;case"unmuteAndHideCaptions":E[g](v+s+"Mute",0);e=s+"CC";t=0;break;case"showCaptions":e=s+"CC";break;case"hideCaptions":e=s+"CC";t=0;break;case"info":e=h===5?l:r+"Info";break;case"hidePlaybar":e=h>3?i+"ShowPlaybar":r+"HidePlaybar";t=h>3?0:1;break;case"showPlaybar":e=h>3?i+"ShowPlaybar":r+"HidePlaybar";t=h>3?1:0;break;case"lockTOC":e=h>3?"cpLockTOC":l;break;case"unlockTOC":e=h>3?"cpLockTOC":l;t=0;break;case"exit":e=r+"Exit";break;default:e=l}if(e){E[g](v+e,t)}return c};var N=function(e,t){if(!x()){return l}if(h===6){e="m_VarHandle."+e}var n=null,r=typeof t!==o&&t?"":v;switch(e){case"rdinfoHasPlaybar":try{n=E[m](e)}catch(i){}if(typeof n===o||n===null){try{n=E[m](r+e)}catch(s){}}n=typeof n!==o?n:l;break;case"playbarHeight":case"playbarPosition":if(!b){try{n=E.GetVariable(e)}catch(u){try{n=E.GetVariable(r+e)}catch(a){}}}else{if(h===5){r=""}n=E[m](r+e)}break;case"movieXML":case"PlaybarProperties":try{n=E.cpEIXMLGetValue(r+e)}catch(f){}if(typeof n===o||n===null){try{n=E.cpEIXMLGetValue(e)}catch(c){}}break;default:try{n=E[m](r+e)}catch(p){}if(typeof n===o||n===null){try{n=E[m](e)}catch(d){}}}return typeof n!==o?n:null};var C=function(e,t,n){if(!x()){return l}if(h===6){e="m_VarHandle."+e}var r=null,i=typeof n!==o&&n?"":v;try{E[g](i+e,t)}catch(s){try{E[g](e,t)}catch(u){}}};this.swf=E;this.useZeroIndex=function(e){w=e?f:l};this.pause=function(){return T("pause")};this.resume=function(){return T("resume")};this.next=function(){return T("next")};this.previous=function(){return T("previous")};this.rewindAndStop=function(){return T("rewindAndStop")};this.rewindAndPlay=function(){return T("rewindAndPlay")};this.gotoSlideAndStop=function(e){if(typeof e===a){return T("gotoSlideAndStop",e)}};this.gotoSlideAndPlay=function(e){if(typeof e===a){return T("gotoSlideAndPlay",e)}};this.gotoFrameAndStop=function(e){if(typeof e===a){return T("gotoFrameAndStop",e)}};this.gotoFrameAndPlay=function(e){if(typeof e===a){return T("gotoFrameAndPlay",e)}};this.showInfoBox=function(){return T("info")};this.exit=function(){return T("exit")};this.lockTOC=function(){return T("lockTOC")};this.unlockTOC=function(){return T("unlockTOC")};this.hidePlaybar=function(){return T("hidePlaybar")};this.showPlaybar=function(){return T("showPlaybar")};this.mute=function(){return T("mute")};this.unmute=function(){return T("unmute")};this.muteAndShowCaptions=function(){return T("muteAndShowCaptions")};this.unmuteAndHideCaptions=function(){return T("unmuteAndHideCaptions")};this.showCaptions=function(){return T("showCaptions")};this.hideCaptions=function(){return T("hideCaptions")};this.volume=function(e){if(x()&&h>3){if(typeof e===a){T("volume",e)}return N("cpCmndVolume")}return null};this.query=function(e){return N(e)};this.queryExternalSkin=function(e){return N(e,f)};this.captivateVersion=function(){return x()?h:l};this.asVersion=function(){return x()?b?3:2:l};this.hasSkinSWF=function(){return x()?t:l};this.hasTOC=function(){return x()&&N("NoOfTOCEntries")!==null?f:l};this.width=function(){return x()&&h>3?N("cpMovieWidth"):E.TGetProperty("/",8)};this.height=function(){return x()&&h>3?N("cpMovieHeight"):E.TGetProperty("/",9)};this.FPS=function(){if(!x()){return l}return N("rdinfoFPS")||N("cpInfoFPS")||""};this.hasPlaybar=function(){if(!x()){return l}if(h>3){return N("cpInfoHasPlaybar")?f:l}return N("rdinfoHasPlaybar")?f:l};this.set=function(e,t){C(e,t)};this.percentLoaded=function(){return E.PercentLoaded()};this.getname=function(){return E.TGetProperty("/",13)};this.geturl=function(){return E.TGetProperty("/",15)};return this}